import{s as Xt,n as ie,d as c,p as ae,r as Yt,q as Fe,i as S,b as r,u as Be,l as _,v as W,w as Vt,x as it,y as Zt,g as y,c as d,e as v,m as R,j,h,k as $t,o as el,f as z,t as M,z as Ct,a as J,A as H}from"../chunks/DWTpI_9b.js";import{e as q}from"../chunks/CE5jpK0j.js";import{S as tl,i as ll}from"../chunks/00uyEj5u.js";import{a as sl}from"../chunks/Dqg9LriT.js";function xt(i,e,s){const t=i.slice();t[14]=e[s],t[19]=s;const l=new Date(Date.now()-(34-t[19])*24*60*60*1e3);t[15]=l;const a=t[15].toISOString().split("T")[0];t[16]=a;const n=t[7].publications[t[16]]||0;return t[17]=n,t}function nl(i,e,s){const t=i.slice();return t[20]=e[s],t}function yt(i,e,s){const t=i.slice();return t[24]=e[s],t}function il(i){const e=i.slice(),s=Math.max(...e[6].editors.map(t=>t.total));return e[23]=s,e}function jt(i,e,s){const t=i.slice();return t[28]=e[s],t}function al(i){const e=i.slice(),s=Math.max(...e[6].authors.map(t=>t.total));return e[27]=s,e}function Ot(i,e,s){const t=i.slice();return t[32]=e[s],t}function rl(i){const e=i.slice(),s=Math.max(...e[5].publications.map(t=>t.count));return e[31]=s,e}function Pt(i,e,s){const t=i.slice();return t[35]=e[s][0],t[36]=e[s][1],t}function St(i,e,s){const t=i.slice();return t[35]=e[s][0],t[17]=e[s][1],t}function nt(i){const e=i.slice(),s=Math.max(...Object.values(e[4].stages));return e[39]=s,e}function At(i,e,s){const t=i.slice();return t[42]=e[s][0],t[43]=e[s][1],t}function Ht(i,e,s){const t=i.slice();return t[42]=e[s][0],t[43]=e[s][1],t}function Tt(i){let e,s=i[43]+"",t;return{c(){e=h("option"),t=M(s),this.h()},l(l){e=d(l,"OPTION",{});var a=v(e);t=z(a,s),a.forEach(c),this.h()},h(){e.__value=i[42],it(e,e.__value)},m(l,a){S(l,e,a),r(e,t)},p:ie,d(l){l&&c(e)}}}function zt(i){let e,s=i[43]+"",t;return{c(){e=h("option"),t=M(s),this.h()},l(l){e=d(l,"OPTION",{});var a=v(e);t=z(a,s),a.forEach(c),this.h()},h(){e.__value=i[42],it(e,e.__value)},m(l,a){S(l,e,a),r(e,t)},p:ie,d(l){l&&c(e)}}}function ol(i){var pt,bt,mt,kt,Et,wt,It;let e,s,t,l=(((pt=i[3])==null?void 0:pt.wip)||0)+"",a,n,o,p="Задач в работе",f,b,C,w=(((bt=i[3])==null?void 0:bt.overdue)||0)+"",k,m,u,I="Просрочено",g,P,D,A=(((mt=i[3])==null?void 0:mt.editor_review)||0)+"",Q,N,V,G="На проверке",x,T,X,re=(((kt=i[3])==null?void 0:kt.published)||0)+"",oe,Y,ve,at="Публикаций",Se,K,le,ge,rt="Задачи по этапам",Ue,We,se,pe,ot="% без просрочек",Ge,Je,ne,be,ct="Публикации за период",Ke,Qe,ce,me,dt="Нагрузка по ролям",Xe,de,he,ke,ht="Авторы",Ye,Ze,ue,Ee,ut="Редакторы",$e,Ae,te,we,ft="Календарь публикаций (последний месяц)",et,L=((Et=i[4])==null?void 0:Et.stages)&&Mt(nt(i)),F=((wt=i[4])==null?void 0:wt.stages_no_delay_percent)&&Rt(i);function _t(E,O){var U;return(U=E[5])!=null&&U.publications&&E[5].publications.length>0?Lt:dl}function tt(E,O){return O===Lt?rl(E):E}let Ie=_t(i),Z=Ie(tt(i,Ie));function vt(E,O){var U;return(U=E[6])!=null&&U.authors&&E[6].authors.length>0?Bt:hl}function lt(E,O){return O===Bt?al(E):E}let De=vt(i),$=De(lt(i,De));function gt(E,O){var U;return(U=E[6])!=null&&U.editors&&E[6].editors.length>0?Wt:ul}function st(E,O){return O===Wt?il(E):E}let Ve=gt(i),ee=Ve(st(i,Ve)),B=((It=i[7])==null?void 0:It.publications)&&Jt(i);return{c(){e=h("div"),s=h("div"),t=h("div"),a=M(l),n=j(),o=h("div"),o.textContent=p,f=j(),b=h("div"),C=h("div"),k=M(w),m=j(),u=h("div"),u.textContent=I,g=j(),P=h("div"),D=h("div"),Q=M(A),N=j(),V=h("div"),V.textContent=G,x=j(),T=h("div"),X=h("div"),oe=M(re),Y=j(),ve=h("div"),ve.textContent=at,Se=j(),K=h("div"),le=h("div"),ge=h("h3"),ge.textContent=rt,Ue=j(),L&&L.c(),We=j(),se=h("div"),pe=h("h3"),pe.textContent=ot,Ge=j(),F&&F.c(),Je=j(),ne=h("div"),be=h("h3"),be.textContent=ct,Ke=j(),Z.c(),Qe=j(),ce=h("div"),me=h("h3"),me.textContent=dt,Xe=j(),de=h("div"),he=h("div"),ke=h("h4"),ke.textContent=ht,Ye=j(),$.c(),Ze=j(),ue=h("div"),Ee=h("h4"),Ee.textContent=ut,$e=j(),ee.c(),Ae=j(),te=h("div"),we=h("h3"),we.textContent=ft,et=j(),B&&B.c(),this.h()},l(E){e=d(E,"DIV",{class:!0});var O=v(e);s=d(O,"DIV",{class:!0});var U=v(s);t=d(U,"DIV",{class:!0});var je=v(t);a=z(je,l),je.forEach(c),n=y(U),o=d(U,"DIV",{class:!0,"data-svelte-h":!0}),R(o)!=="svelte-wcfvl3"&&(o.textContent=p),U.forEach(c),f=y(O),b=d(O,"DIV",{class:!0});var Ce=v(b);C=d(Ce,"DIV",{class:!0});var Oe=v(C);k=z(Oe,w),Oe.forEach(c),m=y(Ce),u=d(Ce,"DIV",{class:!0,"data-svelte-h":!0}),R(u)!=="svelte-7498hk"&&(u.textContent=I),Ce.forEach(c),g=y(O),P=d(O,"DIV",{class:!0});var xe=v(P);D=d(xe,"DIV",{class:!0});var Pe=v(D);Q=z(Pe,A),Pe.forEach(c),N=y(xe),V=d(xe,"DIV",{class:!0,"data-svelte-h":!0}),R(V)!=="svelte-98wqjt"&&(V.textContent=G),xe.forEach(c),x=y(O),T=d(O,"DIV",{class:!0});var ye=v(T);X=d(ye,"DIV",{class:!0});var Dt=v(X);oe=z(Dt,re),Dt.forEach(c),Y=y(ye),ve=d(ye,"DIV",{class:!0,"data-svelte-h":!0}),R(ve)!=="svelte-14kdw96"&&(ve.textContent=at),ye.forEach(c),O.forEach(c),Se=y(E),K=d(E,"DIV",{class:!0});var fe=v(K);le=d(fe,"DIV",{class:!0});var He=v(le);ge=d(He,"H3",{class:!0,"data-svelte-h":!0}),R(ge)!=="svelte-1fqreky"&&(ge.textContent=rt),Ue=y(He),L&&L.l(He),He.forEach(c),We=y(fe),se=d(fe,"DIV",{class:!0});var Te=v(se);pe=d(Te,"H3",{class:!0,"data-svelte-h":!0}),R(pe)!=="svelte-1vbfno9"&&(pe.textContent=ot),Ge=y(Te),F&&F.l(Te),Te.forEach(c),Je=y(fe),ne=d(fe,"DIV",{class:!0});var ze=v(ne);be=d(ze,"H3",{class:!0,"data-svelte-h":!0}),R(be)!=="svelte-d12xjy"&&(be.textContent=ct),Ke=y(ze),Z.l(ze),ze.forEach(c),Qe=y(fe),ce=d(fe,"DIV",{class:!0});var Me=v(ce);me=d(Me,"H3",{class:!0,"data-svelte-h":!0}),R(me)!=="svelte-cwxpek"&&(me.textContent=dt),Xe=y(Me),de=d(Me,"DIV",{class:!0});var Ne=v(de);he=d(Ne,"DIV",{});var Re=v(he);ke=d(Re,"H4",{class:!0,"data-svelte-h":!0}),R(ke)!=="svelte-3nr5ih"&&(ke.textContent=ht),Ye=y(Re),$.l(Re),Re.forEach(c),Ze=y(Ne),ue=d(Ne,"DIV",{});var qe=v(ue);Ee=d(qe,"H4",{class:!0,"data-svelte-h":!0}),R(Ee)!=="svelte-1fvt9le"&&(Ee.textContent=ut),$e=y(qe),ee.l(qe),qe.forEach(c),Ne.forEach(c),Me.forEach(c),fe.forEach(c),Ae=y(E),te=d(E,"DIV",{class:!0});var Le=v(te);we=d(Le,"H3",{class:!0,"data-svelte-h":!0}),R(we)!=="svelte-ryu9x5"&&(we.textContent=ft),et=y(Le),B&&B.l(Le),Le.forEach(c),this.h()},h(){_(t,"class","text-3xl font-bold text-blue-400"),_(o,"class","text-sm text-gray-500 mt-1"),_(s,"class","bg-white rounded-lg p-6"),_(C,"class","text-3xl font-bold text-red-400"),_(u,"class","text-sm text-gray-500 mt-1"),_(b,"class","bg-white rounded-lg p-6"),_(D,"class","text-3xl font-bold text-purple-400"),_(V,"class","text-sm text-gray-500 mt-1"),_(P,"class","bg-white rounded-lg p-6"),_(X,"class","text-3xl font-bold text-green-400"),_(ve,"class","text-sm text-gray-500 mt-1"),_(T,"class","bg-white rounded-lg p-6"),_(e,"class","grid grid-cols-4 gap-4 mb-8"),_(ge,"class","text-lg font-semibold mb-4"),_(le,"class","bg-white rounded-lg p-6"),_(pe,"class","text-lg font-semibold mb-4"),_(se,"class","bg-white rounded-lg p-6"),_(be,"class","text-lg font-semibold mb-4"),_(ne,"class","bg-white rounded-lg p-6"),_(me,"class","text-lg font-semibold mb-4"),_(ke,"class","text-sm text-gray-500 mb-2"),_(Ee,"class","text-sm text-gray-500 mb-2"),_(de,"class","space-y-4"),_(ce,"class","bg-white rounded-lg p-6"),_(K,"class","grid grid-cols-2 gap-8"),_(we,"class","text-lg font-semibold mb-4"),_(te,"class","bg-white rounded-lg p-6 mt-8")},m(E,O){S(E,e,O),r(e,s),r(s,t),r(t,a),r(s,n),r(s,o),r(e,f),r(e,b),r(b,C),r(C,k),r(b,m),r(b,u),r(e,g),r(e,P),r(P,D),r(D,Q),r(P,N),r(P,V),r(e,x),r(e,T),r(T,X),r(X,oe),r(T,Y),r(T,ve),S(E,Se,O),S(E,K,O),r(K,le),r(le,ge),r(le,Ue),L&&L.m(le,null),r(K,We),r(K,se),r(se,pe),r(se,Ge),F&&F.m(se,null),r(K,Je),r(K,ne),r(ne,be),r(ne,Ke),Z.m(ne,null),r(K,Qe),r(K,ce),r(ce,me),r(ce,Xe),r(ce,de),r(de,he),r(he,ke),r(he,Ye),$.m(he,null),r(de,Ze),r(de,ue),r(ue,Ee),r(ue,$e),ee.m(ue,null),S(E,Ae,O),S(E,te,O),r(te,we),r(te,et),B&&B.m(te,null)},p(E,O){var U,je,Ce,Oe,xe,Pe,ye;O[0]&8&&l!==(l=(((U=E[3])==null?void 0:U.wip)||0)+"")&&J(a,l),O[0]&8&&w!==(w=(((je=E[3])==null?void 0:je.overdue)||0)+"")&&J(k,w),O[0]&8&&A!==(A=(((Ce=E[3])==null?void 0:Ce.editor_review)||0)+"")&&J(Q,A),O[0]&8&&re!==(re=(((Oe=E[3])==null?void 0:Oe.published)||0)+"")&&J(oe,re),(xe=E[4])!=null&&xe.stages?L?L.p(nt(E),O):(L=Mt(nt(E)),L.c(),L.m(le,null)):L&&(L.d(1),L=null),(Pe=E[4])!=null&&Pe.stages_no_delay_percent?F?F.p(E,O):(F=Rt(E),F.c(),F.m(se,null)):F&&(F.d(1),F=null),Ie===(Ie=_t(E))&&Z?Z.p(tt(E,Ie),O):(Z.d(1),Z=Ie(tt(E,Ie)),Z&&(Z.c(),Z.m(ne,null))),De===(De=vt(E))&&$?$.p(lt(E,De),O):($.d(1),$=De(lt(E,De)),$&&($.c(),$.m(he,null))),Ve===(Ve=gt(E))&&ee?ee.p(st(E,Ve),O):(ee.d(1),ee=Ve(st(E,Ve)),ee&&(ee.c(),ee.m(ue,null))),(ye=E[7])!=null&&ye.publications?B?B.p(E,O):(B=Jt(E),B.c(),B.m(te,null)):B&&(B.d(1),B=null)},d(E){E&&(c(e),c(Se),c(K),c(Ae),c(te)),L&&L.d(),F&&F.d(),Z.d(),$.d(),ee.d(),B&&B.d()}}}function cl(i){let e,s='<div class="animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full"></div>';return{c(){e=h("div"),e.innerHTML=s,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-1kc2l0f"&&(e.innerHTML=s),this.h()},h(){_(e,"class","flex items-center justify-center py-20")},m(t,l){S(t,e,l)},p:ie,d(t){t&&c(e)}}}function Mt(i){let e,s=q(Object.entries(i[4].stages)),t=[];for(let l=0;l<s.length;l+=1)t[l]=Nt(St(i,s,l));return{c(){e=h("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=d(l,"DIV",{class:!0});var a=v(e);for(let n=0;n<t.length;n+=1)t[n].l(a);a.forEach(c),this.h()},h(){_(e,"class","space-y-3")},m(l,a){S(l,e,a);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(l,a){if(a[0]&16){s=q(Object.entries(l[4].stages));let n;for(n=0;n<s.length;n+=1){const o=St(l,s,n);t[n]?t[n].p(o,a):(t[n]=Nt(o),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){l&&c(e),ae(t,l)}}}function Nt(i){let e,s,t,l=i[35].replace("_"," ")+"",a,n,o,p=i[17]+"",f,b,C,w,k;return{c(){e=h("div"),s=h("div"),t=h("span"),a=M(l),n=j(),o=h("span"),f=M(p),b=j(),C=h("div"),w=h("div"),k=j(),this.h()},l(m){e=d(m,"DIV",{});var u=v(e);s=d(u,"DIV",{class:!0});var I=v(s);t=d(I,"SPAN",{class:!0});var g=v(t);a=z(g,l),g.forEach(c),n=y(I),o=d(I,"SPAN",{});var P=v(o);f=z(P,p),P.forEach(c),I.forEach(c),b=y(u),C=d(u,"DIV",{class:!0});var D=v(C);w=d(D,"DIV",{class:!0,style:!0}),v(w).forEach(c),D.forEach(c),k=y(u),u.forEach(c),this.h()},h(){_(t,"class","capitalize"),_(s,"class","flex justify-between text-sm mb-1"),_(w,"class","h-full bg-primary-500 rounded-full transition-all duration-500"),W(w,"width",_e(i[17],i[39])+"%"),_(C,"class","h-2 bg-gray-100 rounded-full overflow-hidden")},m(m,u){S(m,e,u),r(e,s),r(s,t),r(t,a),r(s,n),r(s,o),r(o,f),r(e,b),r(e,C),r(C,w),r(e,k)},p(m,u){u[0]&16&&l!==(l=m[35].replace("_"," ")+"")&&J(a,l),u[0]&16&&p!==(p=m[17]+"")&&J(f,p),u[0]&16&&W(w,"width",_e(m[17],m[39])+"%")},d(m){m&&c(e)}}}function Rt(i){let e,s=q(Object.entries(i[4].stages_no_delay_percent)),t=[];for(let l=0;l<s.length;l+=1)t[l]=qt(Pt(i,s,l));return{c(){e=h("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=d(l,"DIV",{class:!0});var a=v(e);for(let n=0;n<t.length;n+=1)t[n].l(a);a.forEach(c),this.h()},h(){_(e,"class","space-y-3")},m(l,a){S(l,e,a);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(l,a){if(a[0]&16){s=q(Object.entries(l[4].stages_no_delay_percent));let n;for(n=0;n<s.length;n+=1){const o=Pt(l,s,n);t[n]?t[n].p(o,a):(t[n]=qt(o),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){l&&c(e),ae(t,l)}}}function qt(i){let e,s,t,l=i[35].replace("_"," ")+"",a,n,o,p=i[36].toFixed(0)+"",f,b,C,w,k,m;return{c(){e=h("div"),s=h("div"),t=h("span"),a=M(l),n=j(),o=h("span"),f=M(p),b=M("%"),C=j(),w=h("div"),k=h("div"),m=j(),this.h()},l(u){e=d(u,"DIV",{});var I=v(e);s=d(I,"DIV",{class:!0});var g=v(s);t=d(g,"SPAN",{class:!0});var P=v(t);a=z(P,l),P.forEach(c),n=y(g),o=d(g,"SPAN",{});var D=v(o);f=z(D,p),b=z(D,"%"),D.forEach(c),g.forEach(c),C=y(I),w=d(I,"DIV",{class:!0});var A=v(w);k=d(A,"DIV",{class:!0,style:!0}),v(k).forEach(c),A.forEach(c),m=y(I),I.forEach(c),this.h()},h(){_(t,"class","capitalize"),H(o,"text-green-400",i[36]>=80),H(o,"text-amber-400",i[36]>=50&&i[36]<80),H(o,"text-red-400",i[36]<50),_(s,"class","flex justify-between text-sm mb-1"),_(k,"class","h-full rounded-full transition-all duration-500"),W(k,"width",i[36]+"%"),H(k,"bg-green-500",i[36]>=80),H(k,"bg-amber-500",i[36]>=50&&i[36]<80),H(k,"bg-red-500",i[36]<50),_(w,"class","h-2 bg-gray-100 rounded-full overflow-hidden")},m(u,I){S(u,e,I),r(e,s),r(s,t),r(t,a),r(s,n),r(s,o),r(o,f),r(o,b),r(e,C),r(e,w),r(w,k),r(e,m)},p(u,I){I[0]&16&&l!==(l=u[35].replace("_"," ")+"")&&J(a,l),I[0]&16&&p!==(p=u[36].toFixed(0)+"")&&J(f,p),I[0]&16&&H(o,"text-green-400",u[36]>=80),I[0]&16&&H(o,"text-amber-400",u[36]>=50&&u[36]<80),I[0]&16&&H(o,"text-red-400",u[36]<50),I[0]&16&&W(k,"width",u[36]+"%"),I[0]&16&&H(k,"bg-green-500",u[36]>=80),I[0]&16&&H(k,"bg-amber-500",u[36]>=50&&u[36]<80),I[0]&16&&H(k,"bg-red-500",u[36]<50)},d(u){u&&c(e)}}}function dl(i){let e,s="Нет данных за период";return{c(){e=h("div"),e.textContent=s,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-hrozig"&&(e.textContent=s),this.h()},h(){_(e,"class","text-gray-500 text-center py-8")},m(t,l){S(t,e,l)},p:ie,d(t){t&&c(e)}}}function Lt(i){var k,m;let e,s,t,l,a=((k=i[5].publications[0])==null?void 0:k.date)+"",n,o,p,f=((m=i[5].publications[i[5].publications.length-1])==null?void 0:m.date)+"",b,C=q(i[5].publications),w=[];for(let u=0;u<C.length;u+=1)w[u]=Ft(Ot(i,C,u));return{c(){e=h("div");for(let u=0;u<w.length;u+=1)w[u].c();s=j(),t=h("div"),l=h("span"),n=M(a),o=j(),p=h("span"),b=M(f),this.h()},l(u){e=d(u,"DIV",{class:!0});var I=v(e);for(let A=0;A<w.length;A+=1)w[A].l(I);I.forEach(c),s=y(u),t=d(u,"DIV",{class:!0});var g=v(t);l=d(g,"SPAN",{});var P=v(l);n=z(P,a),P.forEach(c),o=y(g),p=d(g,"SPAN",{});var D=v(p);b=z(D,f),D.forEach(c),g.forEach(c),this.h()},h(){_(e,"class","flex items-end gap-1 h-40"),_(t,"class","flex justify-between text-xs text-gray-500 mt-2")},m(u,I){S(u,e,I);for(let g=0;g<w.length;g+=1)w[g]&&w[g].m(e,null);S(u,s,I),S(u,t,I),r(t,l),r(l,n),r(t,o),r(t,p),r(p,b)},p(u,I){var g,P;if(I[0]&32){C=q(u[5].publications);let D;for(D=0;D<C.length;D+=1){const A=Ot(u,C,D);w[D]?w[D].p(A,I):(w[D]=Ft(A),w[D].c(),w[D].m(e,null))}for(;D<w.length;D+=1)w[D].d(1);w.length=C.length}I[0]&32&&a!==(a=((g=u[5].publications[0])==null?void 0:g.date)+"")&&J(n,a),I[0]&32&&f!==(f=((P=u[5].publications[u[5].publications.length-1])==null?void 0:P.date)+"")&&J(b,f)},d(u){u&&(c(e),c(s),c(t)),ae(w,u)}}}function Ft(i){let e,s,t,l;return{c(){e=h("div"),s=h("div"),l=j(),this.h()},l(a){e=d(a,"DIV",{class:!0});var n=v(e);s=d(n,"DIV",{class:!0,style:!0,title:!0}),v(s).forEach(c),l=y(n),n.forEach(c),this.h()},h(){_(s,"class","w-full bg-green-500 rounded-t transition-all duration-500"),W(s,"height",_e(i[32].count,i[31])+"%"),_(s,"title",t=i[32].date+": "+i[32].count),_(e,"class","flex-1 flex flex-col items-center")},m(a,n){S(a,e,n),r(e,s),r(e,l)},p(a,n){n[0]&32&&W(s,"height",_e(a[32].count,a[31])+"%"),n[0]&32&&t!==(t=a[32].date+": "+a[32].count)&&_(s,"title",t)},d(a){a&&c(e)}}}function hl(i){let e,s="Нет данных";return{c(){e=h("div"),e.textContent=s,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-cvjoxw"&&(e.textContent=s),this.h()},h(){_(e,"class","text-gray-500 text-sm")},m(t,l){S(t,e,l)},p:ie,d(t){t&&c(e)}}}function Bt(i){let e,s=q(i[6].authors.slice(0,5)),t=[];for(let l=0;l<s.length;l+=1)t[l]=Ut(jt(i,s,l));return{c(){e=h("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=d(l,"DIV",{class:!0});var a=v(e);for(let n=0;n<t.length;n+=1)t[n].l(a);a.forEach(c),this.h()},h(){_(e,"class","space-y-2")},m(l,a){S(l,e,a);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(l,a){if(a[0]&64){s=q(l[6].authors.slice(0,5));let n;for(n=0;n<s.length;n+=1){const o=jt(l,s,n);t[n]?t[n].p(o,a):(t[n]=Ut(o),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){l&&c(e),ae(t,l)}}}function Ut(i){let e,s,t=i[28].user_id.slice(0,8)+"",l,a,n,o,p,f,b=i[28].total+"",C,w;return{c(){e=h("div"),s=h("div"),l=M(t),a=j(),n=h("div"),o=h("div"),p=j(),f=h("div"),C=M(b),w=j(),this.h()},l(k){e=d(k,"DIV",{class:!0});var m=v(e);s=d(m,"DIV",{class:!0});var u=v(s);l=z(u,t),u.forEach(c),a=y(m),n=d(m,"DIV",{class:!0});var I=v(n);o=d(I,"DIV",{class:!0,style:!0}),v(o).forEach(c),I.forEach(c),p=y(m),f=d(m,"DIV",{class:!0});var g=v(f);C=z(g,b),g.forEach(c),w=y(m),m.forEach(c),this.h()},h(){_(s,"class","w-20 text-xs truncate"),_(o,"class","h-full bg-blue-500 rounded-full"),W(o,"width",_e(i[28].total,i[27])+"%"),_(n,"class","flex-1 h-4 bg-gray-100 rounded-full overflow-hidden"),_(f,"class","w-8 text-xs text-right"),_(e,"class","flex items-center gap-2")},m(k,m){S(k,e,m),r(e,s),r(s,l),r(e,a),r(e,n),r(n,o),r(e,p),r(e,f),r(f,C),r(e,w)},p(k,m){m[0]&64&&t!==(t=k[28].user_id.slice(0,8)+"")&&J(l,t),m[0]&64&&W(o,"width",_e(k[28].total,k[27])+"%"),m[0]&64&&b!==(b=k[28].total+"")&&J(C,b)},d(k){k&&c(e)}}}function ul(i){let e,s="Нет данных";return{c(){e=h("div"),e.textContent=s,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-cvjoxw"&&(e.textContent=s),this.h()},h(){_(e,"class","text-gray-500 text-sm")},m(t,l){S(t,e,l)},p:ie,d(t){t&&c(e)}}}function Wt(i){let e,s=q(i[6].editors.slice(0,5)),t=[];for(let l=0;l<s.length;l+=1)t[l]=Gt(yt(i,s,l));return{c(){e=h("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=d(l,"DIV",{class:!0});var a=v(e);for(let n=0;n<t.length;n+=1)t[n].l(a);a.forEach(c),this.h()},h(){_(e,"class","space-y-2")},m(l,a){S(l,e,a);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(l,a){if(a[0]&64){s=q(l[6].editors.slice(0,5));let n;for(n=0;n<s.length;n+=1){const o=yt(l,s,n);t[n]?t[n].p(o,a):(t[n]=Gt(o),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){l&&c(e),ae(t,l)}}}function Gt(i){let e,s,t=i[24].user_id.slice(0,8)+"",l,a,n,o,p,f,b=i[24].total+"",C,w;return{c(){e=h("div"),s=h("div"),l=M(t),a=j(),n=h("div"),o=h("div"),p=j(),f=h("div"),C=M(b),w=j(),this.h()},l(k){e=d(k,"DIV",{class:!0});var m=v(e);s=d(m,"DIV",{class:!0});var u=v(s);l=z(u,t),u.forEach(c),a=y(m),n=d(m,"DIV",{class:!0});var I=v(n);o=d(I,"DIV",{class:!0,style:!0}),v(o).forEach(c),I.forEach(c),p=y(m),f=d(m,"DIV",{class:!0});var g=v(f);C=z(g,b),g.forEach(c),w=y(m),m.forEach(c),this.h()},h(){_(s,"class","w-20 text-xs truncate"),_(o,"class","h-full bg-purple-500 rounded-full"),W(o,"width",_e(i[24].total,i[23])+"%"),_(n,"class","flex-1 h-4 bg-gray-100 rounded-full overflow-hidden"),_(f,"class","w-8 text-xs text-right"),_(e,"class","flex items-center gap-2")},m(k,m){S(k,e,m),r(e,s),r(s,l),r(e,a),r(e,n),r(n,o),r(e,p),r(e,f),r(f,C),r(e,w)},p(k,m){m[0]&64&&t!==(t=k[24].user_id.slice(0,8)+"")&&J(l,t),m[0]&64&&W(o,"width",_e(k[24].total,k[23])+"%"),m[0]&64&&b!==(b=k[24].total+"")&&J(C,b)},d(k){k&&c(e)}}}function Jt(i){let e,s,t=q(["Пн","Вт","Ср","Чт","Пт","Сб","Вс"]),l=[];for(let o=0;o<7;o+=1)l[o]=fl(nl(i,t,o));let a=q(Array(35)),n=[];for(let o=0;o<a.length;o+=1)n[o]=Qt(xt(i,a,o));return{c(){e=h("div");for(let o=0;o<7;o+=1)l[o].c();s=j();for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=d(o,"DIV",{class:!0});var p=v(e);for(let f=0;f<7;f+=1)l[f].l(p);s=y(p);for(let f=0;f<n.length;f+=1)n[f].l(p);p.forEach(c),this.h()},h(){_(e,"class","grid grid-cols-7 gap-2")},m(o,p){S(o,e,p);for(let f=0;f<7;f+=1)l[f]&&l[f].m(e,null);r(e,s);for(let f=0;f<n.length;f+=1)n[f]&&n[f].m(e,null)},p(o,p){if(p[0]&128){a=q(Array(35));let f;for(f=0;f<a.length;f+=1){const b=xt(o,a,f);n[f]?n[f].p(b,p):(n[f]=Qt(b),n[f].c(),n[f].m(e,null))}for(;f<n.length;f+=1)n[f].d(1);n.length=a.length}},d(o){o&&c(e),ae(l,o),ae(n,o)}}}function fl(i){let e,s;return{c(){e=h("div"),s=M(i[20]),this.h()},l(t){e=d(t,"DIV",{class:!0});var l=v(e);s=z(l,i[20]),l.forEach(c),this.h()},h(){_(e,"class","text-center text-xs text-gray-500 pb-2")},m(t,l){S(t,e,l),r(e,s)},p:ie,d(t){t&&c(e)}}}function Kt(i){let e=i[17]+"",s;return{c(){s=M(e)},l(t){s=z(t,e)},m(t,l){S(t,s,l)},p(t,l){l[0]&128&&e!==(e=t[17]+"")&&J(s,e)},d(t){t&&c(s)}}}function Qt(i){let e,s,t,l=i[17]>0&&Kt(i);return{c(){e=h("div"),l&&l.c(),s=j(),this.h()},l(a){e=d(a,"DIV",{class:!0,title:!0});var n=v(e);l&&l.l(n),s=y(n),n.forEach(c),this.h()},h(){_(e,"class","aspect-square rounded flex items-center justify-center text-xs transition-colors"),_(e,"title",t=i[16]+": "+i[17]+" публикаций"),H(e,"bg-gray-100",i[17]===0),H(e,"bg-green-900",i[17]===1),H(e,"bg-green-700",i[17]===2),H(e,"bg-green-500",i[17]>=3)},m(a,n){S(a,e,n),l&&l.m(e,null),r(e,s)},p(a,n){a[17]>0?l?l.p(a,n):(l=Kt(a),l.c(),l.m(e,s)):l&&(l.d(1),l=null),n[0]&128&&t!==(t=a[16]+": "+a[17]+" публикаций")&&_(e,"title",t),n[0]&128&&H(e,"bg-gray-100",a[17]===0),n[0]&128&&H(e,"bg-green-900",a[17]===1),n[0]&128&&H(e,"bg-green-700",a[17]===2),n[0]&128&&H(e,"bg-green-500",a[17]>=3)},d(a){a&&c(e),l&&l.d()}}}function _l(i){let e,s,t,l,a="Аналитика",n,o,p,f,b,C,w="Сравнить с...",k,m,u,I=q(Object.entries(i[8])),g=[];for(let V=0;V<I.length;V+=1)g[V]=Tt(Ht(i,I,V));let P=q(Object.entries(i[8])),D=[];for(let V=0;V<P.length;V+=1)D[V]=zt(At(i,P,V));function A(V,G){return V[2]?cl:ol}let Q=A(i),N=Q(i);return{c(){e=j(),s=h("div"),t=h("div"),l=h("h1"),l.textContent=a,n=j(),o=h("div"),p=h("select");for(let V=0;V<g.length;V+=1)g[V].c();f=j(),b=h("select"),C=h("option"),C.textContent=w;for(let V=0;V<D.length;V+=1)D[V].c();k=j(),N.c(),this.h()},l(V){Zt("svelte-dr2szy",document.head).forEach(c),e=y(V),s=d(V,"DIV",{class:!0});var x=v(s);t=d(x,"DIV",{class:!0});var T=v(t);l=d(T,"H1",{class:!0,"data-svelte-h":!0}),R(l)!=="svelte-1s1cnbs"&&(l.textContent=a),n=y(T),o=d(T,"DIV",{class:!0});var X=v(o);p=d(X,"SELECT",{class:!0,style:!0});var re=v(p);for(let Y=0;Y<g.length;Y+=1)g[Y].l(re);re.forEach(c),f=y(X),b=d(X,"SELECT",{class:!0,style:!0});var oe=v(b);C=d(oe,"OPTION",{"data-svelte-h":!0}),R(C)!=="svelte-hv9vpz"&&(C.textContent=w);for(let Y=0;Y<D.length;Y+=1)D[Y].l(oe);oe.forEach(c),X.forEach(c),T.forEach(c),k=y(x),N.l(x),x.forEach(c),this.h()},h(){document.title="Аналитика | CRM",_(l,"class","text-2xl font-bold"),_(p,"class","px-4 py-2 pr-8 bg-gray-100 border border-gray-300 rounded-lg appearance-none bg-no-repeat cursor-pointer"),W(p,"background-image","url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%236b7280%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e')"),W(p,"background-position","right 0.5rem center"),W(p,"background-size","1.25rem"),i[0]===void 0&&Vt(()=>i[10].call(p)),C.__value="",it(C,C.__value),_(b,"class","px-4 py-2 pr-8 bg-gray-100 border border-gray-300 rounded-lg appearance-none bg-no-repeat cursor-pointer"),W(b,"background-image","url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%236b7280%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e')"),W(b,"background-position","right 0.5rem center"),W(b,"background-size","1.25rem"),i[1]===void 0&&Vt(()=>i[11].call(b)),_(o,"class","flex items-center gap-4"),_(t,"class","flex items-center justify-between mb-8"),_(s,"class","p-8")},m(V,G){S(V,e,G),S(V,s,G),r(s,t),r(t,l),r(t,n),r(t,o),r(o,p);for(let x=0;x<g.length;x+=1)g[x]&&g[x].m(p,null);Fe(p,i[0],!0),r(o,f),r(o,b),r(b,C);for(let x=0;x<D.length;x+=1)D[x]&&D[x].m(b,null);Fe(b,i[1],!0),r(s,k),N.m(s,null),m||(u=[Be(p,"change",i[10]),Be(p,"change",i[9]),Be(b,"change",i[11]),Be(b,"change",i[9])],m=!0)},p(V,G){if(G[0]&256){I=q(Object.entries(V[8]));let x;for(x=0;x<I.length;x+=1){const T=Ht(V,I,x);g[x]?g[x].p(T,G):(g[x]=Tt(T),g[x].c(),g[x].m(p,null))}for(;x<g.length;x+=1)g[x].d(1);g.length=I.length}if(G[0]&257&&Fe(p,V[0]),G[0]&256){P=q(Object.entries(V[8]));let x;for(x=0;x<P.length;x+=1){const T=At(V,P,x);D[x]?D[x].p(T,G):(D[x]=zt(T),D[x].c(),D[x].m(b,null))}for(;x<D.length;x+=1)D[x].d(1);D.length=P.length}G[0]&258&&Fe(b,V[1]),Q===(Q=A(V))&&N?N.p(V,G):(N.d(1),N=Q(V),N&&(N.c(),N.m(s,null)))},i:ie,o:ie,d(V){V&&(c(e),c(s)),ae(g,V),ae(D,V),N.d(),m=!1,Yt(u)}}}function _e(i,e){return e?Math.round(i/e*100):0}function vl(i,e,s){let t;$t(i,sl,g=>s(12,t=g));let l="month",a="",n=!0,o=null,p=null,f=null,b=null,C=null;const w={month:"Месяц",quarter:"Квартал",half_year:"Полгода",year:"Год"};el(()=>{k()});async function k(){s(2,n=!0);try{const g={Authorization:`Bearer ${t.token}`},P=new URLSearchParams({period:l});a&&P.append("compare_period",a);const[D,A,Q,N,V]=await Promise.all([fetch(`/api/analytics/summary?${P}`,{headers:g}),fetch(`/api/analytics/stages?${P}`,{headers:g}),fetch(`/api/analytics/publications?${P}`,{headers:g}),fetch(`/api/analytics/roles?${P}`,{headers:g}),fetch("/api/analytics/calendar",{headers:g})]);s(3,o=await D.json()),s(4,p=await A.json()),s(5,f=await Q.json()),s(6,b=await N.json()),s(7,C=await V.json())}catch(g){console.error("Failed to load analytics:",g)}s(2,n=!1)}function m(){k()}function u(){l=Ct(this),s(0,l),s(8,w)}function I(){a=Ct(this),s(1,a),s(8,w)}return[l,a,n,o,p,f,b,C,w,m,u,I]}class kl extends tl{constructor(e){super(),ll(this,e,vl,_l,Xt,{},null,[-1,-1])}}export{kl as component};
